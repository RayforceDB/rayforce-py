/*
 *   Copyright (c) 2025 Anton Kundenko <singaraiona@gmail.com>
 *   All rights reserved.
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy
 *   of this software and associated documentation files (the "Software"), to deal
 *   in the Software without restriction, including without limitation the rights
 *   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the Software is
 *   furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all
 *   copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *   SOFTWARE.
 */

/* ============================================================================
   PRODUCTION-GRADE COLOR PALETTE SYSTEM
   Inspired by MDN, Stripe Docs, Vercel, GitHub Docs, Linear
   WCAG AA/AAA compliant, optimized for readability and low eye-strain
   ============================================================================ */

/* ----------------------------------------------------------------------------
   LIGHT MODE COLOR TOKENS
   ---------------------------------------------------------------------------- */
[data-md-color-scheme="default"] {
  /* Text Colors - High contrast, softened black */
  --text-primary: #1a1a1a;        /* Main body text - WCAG AAA (21:1) */
  --text-secondary: #4a5568;       /* Secondary text - WCAG AA (7.2:1) */
  --text-tertiary: #718096;       /* Tertiary/muted text - WCAG AA (4.8:1) */
  --text-inverse: #ffffff;         /* Text on dark backgrounds */
  
  /* Background Colors - Slightly warm white, not stark */
  --bg-primary: #ffffff;           /* Main background */
  --bg-secondary: #f7fafc;        /* Secondary background (cards, sections) */
  --bg-tertiary: #edf2f7;         /* Tertiary background (hover states) */
  --bg-elevated: #ffffff;          /* Elevated surfaces (modals, dropdowns) */
  
  /* Border Colors - Subtle, low-saturation */
  --border-primary: #e2e8f0;        /* Primary borders */
  --border-secondary: #cbd5e0;      /* Secondary borders */
  --border-focus: #c53030;         /* Focus ring (red accent) */
  
  /* Accent Colors - Restrained, accessible red */
  --accent-primary: #c53030;       /* Primary accent (red) - WCAG AA (4.8:1) */
  --accent-hover: #9b2c2c;         /* Hover state - darker red */
  --accent-active: #742a2a;        /* Active state - darkest red */
  --accent-light: #fed7d7;         /* Light accent background */
  
  /* Link Colors */
  --link-color: #c53030;           /* Links - matches accent */
  --link-hover: #9b2c2c;           /* Link hover */
  --link-visited: #9b2c2c;          /* Visited links */
  
  /* Code Colors - Subtle, readable */
  --code-bg: #f7fafc;              /* Code block background */
  --code-text: #1a1a1a;            /* Code text */
  --code-border: #e2e8f0;          /* Code block border */
  --code-inline-bg: #f1f5f9;       /* Inline code background */
  
  /* Syntax Highlighting - Accessible, low-saturation */
  --code-hl-keyword: #7c3aed;      /* Keywords (purple) - WCAG AA */
  --code-hl-string: #059669;        /* Strings (green) - WCAG AA */
  --code-hl-number: #dc2626;        /* Numbers (red) - WCAG AA */
  --code-hl-function: #0284c7;       /* Functions (blue) - WCAG AA */
  --code-hl-comment: #64748b;       /* Comments (muted gray) */
  --code-hl-operator: #7c2d12;      /* Operators (brown) */
  --code-hl-punctuation: #475569;    /* Punctuation (gray) */
  
  /* Callout Colors - Semantic, accessible */
  --callout-info-bg: #dbeafe;       /* Info background */
  --callout-info-border: #3b82f6;   /* Info border */
  --callout-info-text: #1e40af;     /* Info text */
  
  --callout-warn-bg: #fef3c7;       /* Warning background */
  --callout-warn-border: #f59e0b;   /* Warning border */
  --callout-warn-text: #92400e;     /* Warning text */
  
  --callout-danger-bg: #fee2e2;     /* Danger background */
  --callout-danger-border: #ef4444; /* Danger border */
  --callout-danger-text: #991b1b;   /* Danger text */
  
  --callout-success-bg: #d1fae5;   /* Success background */
  --callout-success-border: #10b981; /* Success border */
  --callout-success-text: #065f46;  /* Success text */
  
  /* Shadow Colors */
  --shadow-sm: rgba(0, 0, 0, 0.05);
  --shadow-md: rgba(0, 0, 0, 0.1);
  --shadow-lg: rgba(0, 0, 0, 0.15);
}

/* ----------------------------------------------------------------------------
   DARK MODE COLOR TOKENS
   ---------------------------------------------------------------------------- */
[data-md-color-scheme="slate"] {
  /* Text Colors - Soft white, not pure */
  --text-primary: #f7fafc;         /* Main body text - WCAG AAA */
  --text-secondary: #cbd5e0;       /* Secondary text - WCAG AA */
  --text-tertiary: #a0aec0;        /* Tertiary/muted text - WCAG AA */
  --text-inverse: #1a1a1a;         /* Text on light backgrounds */
  
  /* Background Colors - Deep charcoal, not pure black */
  --bg-primary: #0f172a;           /* Main background (slate-900) */
  --bg-secondary: #1e293b;          /* Secondary background (slate-800) */
  --bg-tertiary: #334155;           /* Tertiary background (slate-700) */
  --bg-elevated: #1e293b;           /* Elevated surfaces */
  
  /* Border Colors - Subtle, visible */
  --border-primary: #334155;        /* Primary borders */
  --border-secondary: #475569;      /* Secondary borders */
  --border-focus: #f87171;          /* Focus ring (lighter red) */
  
  /* Accent Colors - Lighter for dark mode */
  --accent-primary: #f87171;        /* Primary accent (lighter red) */
  --accent-hover: #fb923c;          /* Hover state (orange-red) */
  --accent-active: #f87171;         /* Active state */
  --accent-light: #7f1d1d;          /* Light accent background */
  
  /* Link Colors */
  --link-color: #f87171;            /* Links */
  --link-hover: #fb923c;             /* Link hover */
  --link-visited: #fb923c;           /* Visited links */
  
  /* Code Colors */
  --code-bg: #1e293b;               /* Code block background */
  --code-text: #f7fafc;             /* Code text */
  --code-border: #334155;            /* Code block border */
  --code-inline-bg: #1e293b;        /* Inline code background */
  
  /* Syntax Highlighting - Adjusted for dark mode */
  --code-hl-keyword: #a78bfa;       /* Keywords (lighter purple) */
  --code-hl-string: #34d399;        /* Strings (lighter green) */
  --code-hl-number: #f87171;        /* Numbers (lighter red) */
  --code-hl-function: #60a5fa;      /* Functions (lighter blue) */
  --code-hl-comment: #94a3b8;       /* Comments (muted) */
  --code-hl-operator: #fb923c;      /* Operators (orange) */
  --code-hl-punctuation: #cbd5e0;   /* Punctuation */
  
  /* Callout Colors - Darker backgrounds */
  --callout-info-bg: #1e3a5f;       /* Info background */
  --callout-info-border: #60a5fa;   /* Info border */
  --callout-info-text: #93c5fd;     /* Info text */
  
  --callout-warn-bg: #78350f;       /* Warning background */
  --callout-warn-border: #fbbf24;   /* Warning border */
  --callout-warn-text: #fcd34d;     /* Warning text */
  
  --callout-danger-bg: #7f1d1d;     /* Danger background */
  --callout-danger-border: #f87171; /* Danger border */
  --callout-danger-text: #fca5a5;  /* Danger text */
  
  --callout-success-bg: #064e3b;   /* Success background */
  --callout-success-border: #34d399; /* Success border */
  --callout-success-text: #6ee7b7;  /* Success text */
  
  /* Shadow Colors - Lighter for dark mode */
  --shadow-sm: rgba(0, 0, 0, 0.3);
  --shadow-md: rgba(0, 0, 0, 0.5);
  --shadow-lg: rgba(0, 0, 0, 0.7);
}

/* ============================================================================
   APPLICATION OF COLOR TOKENS
   ============================================================================ */

/* Base Typography */
.md-typeset {
  color: var(--text-primary);
}

.md-typeset p,
.md-typeset li {
  color: var(--text-primary);
}

.md-typeset h1,
.md-typeset h2,
.md-typeset h3,
.md-typeset h4,
.md-typeset h5,
.md-typeset h6 {
  color: var(--text-primary);
}

/* Links */
.md-typeset a {
  color: var(--link-color);
  text-decoration: none;
  transition: color 0.2s ease;
}

.md-typeset a:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.md-typeset a:visited {
  color: var(--link-visited);
}

/* Code Blocks */
.md-typeset pre {
  background-color: var(--code-bg) !important;
  border: 1px solid var(--code-border);
  color: var(--code-text);
}

.md-typeset code {
  background-color: var(--code-inline-bg);
  color: var(--code-text);
  padding: 0.125em 0.25em;
  border-radius: 0.25em;
}

.md-typeset pre code {
  background-color: transparent;
  padding: 0;
}

/* Syntax Highlighting */
:root {
  --md-code-hl-number-color: var(--code-hl-number);
  --md-code-hl-special-color: var(--code-hl-operator);
  --md-code-hl-function-color: var(--code-hl-function);
  --md-code-hl-constant-color: var(--code-hl-keyword);
  --md-code-hl-keyword-color: var(--code-hl-keyword);
  --md-code-hl-string-color: var(--code-hl-string);
  --md-code-hl-name-color: var(--code-hl-function);
  --md-code-hl-operator-color: var(--code-hl-operator);
  --md-code-hl-punctuation-color: var(--code-hl-punctuation);
  --md-code-hl-comment-color: var(--code-hl-comment);
  --md-code-hl-generic-color: var(--code-hl-function);
}

/* Header & Navigation */
.md-header {
  background-color: var(--accent-primary) !important;
  color: var(--text-inverse);
  border-bottom: none;
}

.md-tabs {
  background-color: transparent;
  border: none;
  padding: 0.5rem 0;
  box-shadow: none;
}

/* Transparent tabs for light mode */
[data-md-color-scheme="default"] .md-tabs {
  background-color: transparent;
  border: none;
  box-shadow: none;
}

/* Remove any borders from tab container on home page */
body:has(.hero-section) .md-tabs {
  background-color: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

.md-tabs__link {
  font-weight: 500;
  transition: all 0.2s ease;
  padding: 0.6rem 1.2rem;
  margin: 0 0.25rem;
  border-radius: 8px 8px 0 0;
  display: inline-block;
}

.md-tabs__link:hover {
  opacity: 1;
  background-color: rgba(197, 48, 48, 0.2);
}

.md-tabs__link--active {
  opacity: 1;
}

/* Bookmark-style tabs for light mode - default (non-home pages) */
[data-md-color-scheme="default"] .md-tabs__link {
  color: #4a5568 !important;
  opacity: 0.9;
  background-color: transparent;
}

[data-md-color-scheme="default"] .md-tabs__link:hover {
  color: #1a1a1a !important;
  opacity: 1;
  background-color: rgba(197, 48, 48, 0.1);
}

/* White tabs only on home page with hero section */
body:has(.hero-section) [data-md-color-scheme="default"] .md-tabs__link {
  color: rgba(255, 255, 255, 0.8) !important;
}

body:has(.hero-section) [data-md-color-scheme="default"] .md-tabs__link:hover {
  color: rgba(255, 255, 255, 1) !important;
  background-color: rgba(197, 48, 48, 0.3);
}

[data-md-color-scheme="default"] .md-tabs__link--active {
  background-color: var(--accent-primary);
  color: white !important;
  font-weight: 700;
  opacity: 1;
  box-shadow: 0 -2px 8px rgba(197, 48, 48, 0.2);
}

/* Bookmark-style tabs for dark mode */
[data-md-color-scheme="slate"] .md-tabs__link {
  color: rgba(255, 255, 255, 0.7) !important;
}

[data-md-color-scheme="slate"] .md-tabs__link:hover {
  color: var(--accent-primary) !important;
  background-color: rgba(248, 113, 113, 0.1);
}

[data-md-color-scheme="slate"] .md-tabs__link--active {
  background-color: rgba(248, 113, 113, 0.2);
  color: var(--accent-primary) !important;
  font-weight: 700;
  box-shadow: 0 -2px 8px rgba(248, 113, 113, 0.15);
}

/* Search */
.md-search__input {
  background-color: rgba(255, 255, 255, 0.1);
}

/* Light mode - dark text */
[data-md-color-scheme="default"] .md-search__input {
  color: #1a1a1a !important;
  background-color: rgba(255, 255, 255, 0.9);
}

[data-md-color-scheme="default"] .md-search__input::placeholder {
  color: rgba(26, 26, 26, 0.6);
}

/* Dark mode - white text */
[data-md-color-scheme="slate"] .md-search__input {
  color: white !important;
  background-color: rgba(255, 255, 255, 0.1);
}

[data-md-color-scheme="slate"] .md-search__input::placeholder {
  color: rgba(255, 255, 255, 0.6);
}

/* General input fields styling */
[data-md-color-scheme="default"] input,
[data-md-color-scheme="default"] textarea,
[data-md-color-scheme="default"] select {
  color: #1a1a1a !important;
}

[data-md-color-scheme="slate"] input,
[data-md-color-scheme="slate"] textarea,
[data-md-color-scheme="slate"] select {
  color: white !important;
}

/* Navigation */
.md-nav__link {
  color: var(--text-secondary);
}

.md-nav__link:hover {
  color: var(--accent-primary);
}

.md-nav__link--active {
  color: var(--accent-primary);
  font-weight: 600;
}

/* Sidebar */
.md-sidebar {
  background-color: transparent;
}

/* Tables */
.md-typeset table:not([class]) {
  border: 1px solid var(--border-primary);
}

.md-typeset table:not([class]) th {
  background-color: var(--bg-tertiary);
  color: var(--text-primary);
  border-bottom: 2px solid var(--border-secondary);
}

.md-typeset table:not([class]) td {
  border-bottom: 1px solid var(--border-primary);
}

.md-typeset table:not([class]) tr:hover {
  background-color: var(--bg-tertiary);
}

/* Admonitions (Callouts) */
.md-typeset .admonition {
  border-left: 4px solid;
  box-shadow: 0 2px 4px var(--shadow-sm);
}

.md-typeset .admonition.info {
  background-color: var(--callout-info-bg);
  border-color: var(--callout-info-border);
}

.md-typeset .admonition.info .admonition-title {
  background-color: var(--callout-info-border);
  color: var(--text-inverse);
}

.md-typeset .admonition.warning {
  background-color: var(--callout-warn-bg);
  border-color: var(--callout-warn-border);
}

.md-typeset .admonition.warning .admonition-title {
  background-color: var(--callout-warn-border);
  color: var(--text-inverse);
}

.md-typeset .admonition.danger {
  background-color: var(--callout-danger-bg);
  border-color: var(--callout-danger-border);
}

.md-typeset .admonition.danger .admonition-title {
  background-color: var(--callout-danger-border);
  color: var(--text-inverse);
}

.md-typeset .admonition.tip,
.md-typeset .admonition.success {
  background-color: var(--callout-success-bg);
  border-color: var(--callout-success-border);
}

.md-typeset .admonition.tip .admonition-title,
.md-typeset .admonition.success .admonition-title {
  background-color: var(--callout-success-border);
  color: var(--text-inverse);
}

/* Buttons & Interactive Elements */
.md-button {
  background-color: var(--accent-primary);
  color: var(--text-inverse);
  border: 1px solid var(--accent-primary);
  transition: all 0.2s ease;
}

.md-button:hover {
  background-color: var(--accent-hover);
  border-color: var(--accent-hover);
}

.md-button--primary {
  background-color: var(--accent-primary);
}

.md-button--primary:hover {
  background-color: var(--accent-hover);
}

/* Focus States - Accessibility */
*:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}

/* Code Highlighting Background */
.highlight {
  background-color: var(--code-bg);
}

/* ============================================================================
   UTILITY CLASSES
   ============================================================================ */

.flex-container {
  display: flex;
  justify-content: flex-start;
}

.text-item {
  width: 20%;
  padding-right: 2%;
}

.player-item {
  width: 78%;
}

.ray-dense td,
.ray-dense th {
  font-size: 85%;
  padding: 0 .4em;
}

.ray-dense th {
  border-bottom: 1px solid var(--border-primary);
  opacity: .7;
  text-align: left;
}

.ray-dense thead {
  border-bottom: 1px solid var(--border-secondary);
}

/* REPL styling */
.language-clj {
  font-size: 0.9em;
}

.asciinema-player,
.asciinema-player * {
  font-size: 12px !important;
  display: block;
  overflow-x: auto;
  font-family: 'Roboto Mono', 'Source Code Pro', 'SF Mono', 'SFMono-Regular', ui-monospace, 'DejaVu Sans Mono', 'Menlo',
    'Consolas', 'Roboto', monospace;
  white-space-collapse: preserve;
  text-wrap: nowrap;
}
